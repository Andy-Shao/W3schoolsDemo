<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>XQuery Example</title>
<link rel="stylesheet" href="../../resources/css/note.css"/>
</head>
<body>
<h1>XQuery Example</h1>
<p>Let's try to learn some basic XQuery syntax by looking at an example.</p>
<hr/>

<h2> The XML Example Document</h2>
<p>We will use the following XML document in the examples below.</p>
<p>"books.xml":</p>
<code><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;bookstore&gt;

&lt;book category="COOKING"&gt;
  &lt;title lang="en"&gt;Everyday Italian&lt;/title&gt;
  &lt;author&gt;Giada De Laurentiis&lt;/author&gt;
  &lt;year&gt;2005&lt;/year&gt;
  &lt;price&gt;30.00&lt;/price&gt;
&lt;/book&gt;

&lt;book category="CHILDREN"&gt;
  &lt;title lang="en"&gt;Harry Potter&lt;/title&gt;
  &lt;author&gt;J K. Rowling&lt;/author&gt;
  &lt;year&gt;2005&lt;/year&gt;
  &lt;price&gt;29.99&lt;/price&gt;
&lt;/book&gt;

&lt;book category="WEB"&gt;
  &lt;title lang="en"&gt;XQuery Kick Start&lt;/title&gt;
  &lt;author&gt;James McGovern&lt;/author&gt;
  &lt;author&gt;Per Bothner&lt;/author&gt;
  &lt;author&gt;Kurt Cagle&lt;/author&gt;
  &lt;author&gt;James Linn&lt;/author&gt;
  &lt;author&gt;Vaidyanathan Nagarajan&lt;/author&gt;
  &lt;year&gt;2003&lt;/year&gt;
  &lt;price&gt;49.99&lt;/price&gt;
&lt;/book&gt;

&lt;book category="WEB"&gt;
  &lt;title lang="en"&gt;Learning XML&lt;/title&gt;
  &lt;author&gt;Erik T. Ray&lt;/author&gt;
  &lt;year&gt;2003&lt;/year&gt;
  &lt;price&gt;39.95&lt;/price&gt;
&lt;/book&gt;

&lt;/bookstore&gt;
</pre></code>
<hr/>

<h2>How to Select Nodes From "books.xml"</h2>
<h3>Functions</h3>
<p>XQuery uses functions to extract data from XML documents.</p>
<p>The doc() function is used to open the "books.xml" file:</p>
<code><pre>
doc("books.xml")
</pre></code>
<h3>Path Expressions</h3>
<p>XQuery uses path expressions to navigate through elements in an XML document.</p>
<p>The following path expression is used to select all the title elements in the "books.xml" file:</p>
<code><pre>
doc("books.xml")/bookstore/book/title
</pre></code>
<p>(/bookstore selects the bookstore element, /book selects all the book elements under the bookstore 
element, and /title selects all the title elements under each book element)</p>
<p>The XQuery above will extract the following:</p>
<code><pre>
&lt;title lang="en"&gt;Everyday Italian&lt;/title&gt;
&lt;title lang="en"&gt;Harry Potter&lt;/title&gt;
&lt;title lang="en"&gt;XQuery Kick Start&lt;/title&gt;
&lt;title lang="en"&gt;Learning XML&lt;/title&gt;
</pre></code>
<hr/>

<h3>Predicates</h3>
<p>XQuery uses predicates to limit the extracted data from XML documents.</p>
<p>The following predicate is used to select all the book elements under the bookstore element that 
have a price element with a value that is less than 30:</p>
<code><pre>
doc("books.xml")/bookstore/book[price&lt;30]
</pre></code>
<p>The XQuery above will extract the following:</p>
<code><pre>
&lt;book category="CHILDREN"&gt;
  &lt;title lang="en"&gt;Harry Potter&lt;/title&gt;
  &lt;author&gt;J K. Rowling&lt;/author&gt;
  &lt;year&gt;2005&lt;/year&gt;
  &lt;price&gt;29.99&lt;/price&gt;
&lt;/book&gt;
</pre></code>
</body>
</html>
